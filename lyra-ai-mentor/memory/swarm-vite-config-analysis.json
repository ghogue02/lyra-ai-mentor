{
  "timestamp": "2025-07-07T13:45:00Z",
  "analyzer": "vite-config-analyzer",
  "diagnosis": {
    "error": "504 Outdated Optimize Dep errors for react jsx-dev-runtime and react-dom client",
    "affected_route": "/lyra-maya-demo",
    "root_causes": [
      "Missing specific React entry points in optimizeDeps.include configuration",
      "Aggressive code splitting with lazy loading causing dependency resolution issues",
      "React vendor chunk separation interfering with development server optimization"
    ],
    "specific_issues": [
      {
        "issue": "Missing React entry points",
        "location": "vite.config.ts lines 207-218",
        "detail": "optimizeDeps.include only includes basic React packages, missing jsx-dev-runtime and client entries"
      },
      {
        "issue": "Lazy loading pattern",
        "location": "App.tsx line 48",
        "detail": "LyraNarratedMayaDemo is lazy loaded, may reference React APIs not in initial optimization"
      },
      {
        "issue": "Manual chunk configuration",
        "location": "vite.config.ts lines 92-94",
        "detail": "React vendor chunking may interfere with Vite's dependency discovery"
      }
    ],
    "recommended_fixes": [
      {
        "priority": "high",
        "action": "Add missing React entry points to optimizeDeps.include",
        "code_changes": [
          "Add 'react/jsx-runtime' to optimizeDeps.include",
          "Add 'react/jsx-dev-runtime' to optimizeDeps.include",
          "Add 'react-dom/client' to optimizeDeps.include"
        ]
      },
      {
        "priority": "medium",
        "action": "Force dependency discovery for problematic components",
        "code_changes": [
          "Add entries option to optimizeDeps to pre-scan lazy components",
          "Consider adding force: true to optimizeDeps in development"
        ]
      }
    ]
  },
  "proposed_vite_config_changes": {
    "optimizeDeps": {
      "include": [
        "react",
        "react-dom",
        "react/jsx-runtime",
        "react/jsx-dev-runtime",
        "react-dom/client",
        "react-router-dom",
        "@radix-ui/react-dialog",
        "@radix-ui/react-dropdown-menu",
        "@radix-ui/react-tabs",
        "@tanstack/react-query",
        "date-fns",
        "openai",
        "@supabase/supabase-js"
      ],
      "entries": [
        "src/pages/LyraNarratedMayaDemo.tsx",
        "src/pages/MayaSideBySideFixed.tsx"
      ],
      "force": "mode === 'development'"
    }
  }
}